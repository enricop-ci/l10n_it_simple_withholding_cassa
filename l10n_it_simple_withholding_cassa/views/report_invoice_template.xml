<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_invoice_document_custom" inherit_id="account.report_invoice_document">

    <!-- Remove auto lines and update totals -->
    <xpath expr="//div[@id='total']//table[contains(@class, 'o_total_table')]" position="replace">
      <table class="table o_total_table table-borderless custom-total-table">
        <tr>
            <td><strong>Imponibile:</strong></td>
            <td class="text-end">
                <span t-esc="sum(o.invoice_line_ids.filtered(lambda l: not l.name.startswith('[Ritenuta]')).mapped('price_subtotal'))"
                      t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
            </td>
        </tr>
        <tr>
            <td><strong>IVA 22%:</strong></td>
            <td class="text-end">
                <span t-field="o.amount_tax" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
            </td>
        </tr>
        <tr>
            <td><strong>Totale fattura:</strong></td>
            <td class="text-end">
                <span t-esc="sum(o.invoice_line_ids.filtered(lambda l: not l.name.startswith('[Ritenuta]')).mapped('price_total'))"
                      t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
            </td>
        </tr>
        <tr class="border-black">
            <td><strong>Netto a Pagare:</strong></td>
            <td class="text-end">
                <span t-field="o.amount_total" t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
            </td>
        </tr>
      </table>
    </xpath>

    <!-- Stili CSS -->
    <xpath expr="." position="inside">
      <style>
        .o_total_table {
          width: 60%;
          margin-left: auto;
          margin-right: 0;
        }
        .o_total_table td {
          padding: 2px 8px !important;
          line-height: 1.2 !important;
        }
        .border-black td {
          border-top: 1px solid black !important;
        }
      </style>
    </xpath>

  </template>
</odoo>